<?php
/**
 * Created by PhpStorm.
 * User: galat
 * Date: 28/03/2019
 * Time: 11:34 SA
 */

namespace api\controllers;


use common\models\Category;
use yii\base\Controller;

class TestController extends Controller
{
    /***Tính Phụ Thu danh Mục**/
    public function actionGetCustomFee()
    {
        $data = [
          'price' => 400, // $ gía gốc mỹ
          'quantity' => 7,
          'weight' => 0.5, // kg
          'isNew' => false,
          'cate_id' => rand(1,20),
        ];

        $category = Category::findOne($data['cate_id']);
        $data['rules'] = "";
        if($category){
            $data['rules'] = json_decode($category->categoryGroup->rule,true);
            $data['custom_fee'] = $category->getCustomFee($data['price'], $data['quantity'], $data['weight'], $data['isNew']);
            $data['message'] = "Lấy custom fee thành công";
            \Yii::$app->response->statusCode = 200;
        }else{
            \Yii::$app->response->statusCode = 400;
            $data['message'] = "Lấy custom fee thất bại";
            $data['custom_fee'] = 0;
        }
        \Yii::$app->response->format = 'json';
        \Yii::$app->response->data = $data;
        \Yii::$app->response->send();
        exit();
        //return parent::actions(); // TODO: Change the autogenerated stub
    }
}
